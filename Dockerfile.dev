# 开发模式 Dockerfile - 支持热部署
FROM node:18-alpine

WORKDIR /app

# 复制 package 文件
COPY package*.json ./
COPY pnpm-lock.yaml* ./

# 安装依赖（优先使用 pnpm，如果没有则使用 npm）
RUN if [ -f pnpm-lock.yaml ]; then \
      npm install -g pnpm && pnpm install; \
    else \
      npm install; \
    fi

# 复制源代码
COPY . .

# 暴露 Vite 开发服务器端口
EXPOSE 5173

# 启动 Vite 开发服务器（支持热模块替换）
CMD ["sh", "-c", "if [ -f pnpm-lock.yaml ]; then pnpm run dev --host 0.0.0.0; else npm run dev -- --host 0.0.0.0; fi"]

